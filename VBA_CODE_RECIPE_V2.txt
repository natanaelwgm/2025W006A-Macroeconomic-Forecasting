=====================================================
SELF-CONTAINED RECIPE DASHBOARD - VBA MACROS V2
=====================================================

NO EXTERNAL RECIPES NEEDED!
- User creates own recipes
- Default templates for Monthly/Quarterly/Semesterly/Yearly
- Model checklist (43 models available - all repos combined!)
- Default hyperparameters provided
- Save custom recipes
- Pre-configured data paths to merged datasets


SETUP INSTRUCTIONS:
1. Open SMFdashboard.xlsm in Excel
2. Press Alt+F11 to open VBA Editor
3. Insert → Module (or use existing module)
4. Copy-paste ALL macros below into the module
5. Close VBA Editor (Alt+Q)


=====================================================
CORE MACROS - COPY ALL OF THESE
=====================================================

' ================== DASHBOARD SETUP ==================
Sub SetupRecipeDashboard()
    RunPython ("import SMFdashboard_recipe; SMFdashboard_recipe.setup_recipe_dashboard()")
End Sub


' ================== DATA OPERATIONS ==================
Sub GenerateDummyData()
    RunPython ("import SMFdashboard_recipe; SMFdashboard_recipe.btn_generate_dummy_data()")
End Sub

Sub LoadRealData()
    RunPython ("import SMFdashboard_recipe; SMFdashboard_recipe.btn_load_data()")
End Sub


' ================== CONFIGURATION ==================
Sub ApplyTemplate()
    RunPython ("import SMFdashboard_recipe; SMFdashboard_recipe.btn_apply_template()")
End Sub

Sub ViewConfiguration()
    RunPython ("import SMFdashboard_recipe; SMFdashboard_recipe.btn_view_recipe()")
End Sub

Sub SaveRecipe()
    RunPython ("import SMFdashboard_recipe; SMFdashboard_recipe.btn_save_recipe()")
End Sub


' ================== ANALYSIS ==================
Sub RunBackcast()
    RunPython ("import SMFdashboard_recipe; SMFdashboard_recipe.btn_recipe_backcast()")
End Sub

Sub RunForecast()
    RunPython ("import SMFdashboard_recipe; SMFdashboard_recipe.btn_recipe_forecast()")
End Sub

Sub RefreshCharts()
    RunPython ("import SMFdashboard_recipe; SMFdashboard_recipe.btn_refresh_charts()")
End Sub

Sub ViewRankings()
    RunPython ("import SMFdashboard_recipe; SMFdashboard_recipe.btn_view_rankings()")
End Sub

Sub RunForecast()
    RunPython ("import SMFdashboard_recipe; SMFdashboard_recipe.btn_recipe_forecast()")
End Sub

Sub ClearResults()
    RunPython ("import SMFdashboard_recipe; SMFdashboard_recipe.btn_clear_results()")
End Sub


=====================================================
BUTTON SETUP GUIDE
=====================================================

RECOMMENDED BUTTON LAYOUT:

ROW 1 - SETUP:
  [Setup Dashboard]     - SetupRecipeDashboard
  [View Config]         - ViewConfiguration

ROW 2 - DATA:
  [Load Real Data]      - LoadRealData
  [Generate Dummy Data] - GenerateDummyData

ROW 3 - VALIDATION:
  [Run Backcast]        - RunBackcast
  [Refresh Charts]      - RefreshCharts
  [View Rankings]       - ViewRankings

ROW 4 - FORECASTING:
  [Run Forecast]        - RunForecast

ROW 5 - UTILITIES:
  [Clear Results]       - ClearResults (NEW!)
  [Save Recipe]         - SaveRecipe


HOW TO ADD BUTTONS:
1. Go to Developer tab → Insert → Button (Form Control)
2. Draw button on Dashboard sheet
3. Assign corresponding macro
4. Right-click button → Edit Text → Change label


=====================================================
NEW WORKFLOW (NO EXTERNAL RECIPES!)
=====================================================

STEP 1: SETUP DASHBOARD
- Click "Setup Dashboard"
- Sets up all sheets and default configuration
- Creates Recipe_Config sheet with model checklist

STEP 2: CHOOSE FREQUENCY
- In Dashboard cell B4, enter: Monthly, Quarterly, Semesterly, or Yearly
- This determines default horizons and settings

STEP 3: LOAD DATA
Option A - REAL DATA (Recommended):
- Click "Load Real Data"
- Loads from path in Recipe_Config cell B5
- Default: /Users/schalkeanindya/SMFdashboard/data/merged/smf_monthly_data.csv

Option B - DUMMY DATA (For Testing):
- Click "Generate Dummy Data"
- Creates 10 economic variables (246 months)
- Variables match recipe format (CPI, GDP, BI7DRR, etc.)

STEP 4: CONFIGURE MODELS & TRAIN/TEST DATES
- Click "View Config" to open Recipe_Config sheet
- CHECK/UNCHECK models in column A (rows 10-53):
  ✓ 44 models total including:
    • Naive, SeasonalNaive, Drift, MovingAverage, ExpSmoothing
    • Linear, Ridge, Lasso, ElasticNet, Huber, PLS1, etc.
    • RandomForest, XGBoost, GradientBoosting, LightGBM, CatBoost
    • DecisionTree, ExtraTrees, Bagging
    • ARIMA, SARIMAX, AR1, ARp, BVAR, VAR, TVP
    • KNN, SVR, NeuralNetwork
    • DFM, DFM2, PCA
    • GARCH, NeuroGARCH, DNS, MIDAS
    • LSTM, GRU, Transformer

- SET TRAIN/TEST DATES in Recipe_Config (rows 56-60):
  • Train Start Date: 2005-01-01 (row 57)
  • Train End Date: 2019-12-31 (row 58)
  • Test Start Date: 2020-01-01 (row 59)
  • Test End Date: 2024-12-31 (row 60)
  → These dates define when models train and when they're tested!

STEP 5: ADJUST HYPERPARAMETERS (Optional)
- Edit column G in Recipe_Config for hyperparameter values
- Default values already provided for all models
- Examples:
  * RandomForest n_estimators: 100
  * XGBoost learning_rate: 0.1
  * Ridge alpha: 1.0

STEP 6: RUN BACKCAST (DATE-BASED!)
- Click "Run Backcast"
- Uses date-based train/test split (not percentage!)
- Tests all checked models on historical data
- Shows:
  * Performance metrics (RMSE, MAE, R²)
  * Actual vs Predicted values for top 3 models
  * Date range info at top of results
  * Uses REAL models from your selection (not dummy models!)

STEP 7: RUN FORECAST (NEW!)
- Click "Run Forecast"
- Generates future predictions using top N models
- Trains on ALL historical data (not just train set)
- Uses proper lagged features like your other repo
- Multi-horizon forecasts (1, 3, 6, 12 steps ahead)
- Results in Forecast_Results sheet

STEP 8: VIEW CHARTS
- Click "Refresh Charts"
- Creates charts for ALL variables
- Shows backcast validation (actual vs predicted)
- Shows Top N models (default 3, change in cell G5)

STEP 8: SAVE YOUR RECIPE
- Enter recipe name in Dashboard cell B7
- Click "Save Recipe"
- Saves to: /Users/schalkeanindya/SMFdashboard/custom_recipes/
- Includes all your selected models and hyperparameters


=====================================================
FREQUENCY TEMPLATES
=====================================================

MONTHLY:
- Horizons: 1, 3, 6, 12, 24 months
- Test periods: 12 months
- Best for: Monthly economic data

QUARTERLY:
- Horizons: 1, 2, 4, 8 quarters
- Test periods: 4 quarters  
- Best for: Quarterly reports

SEMESTERLY:
- Horizons: 1, 2, 3, 4 semesters
- Test periods: 2 semesters
- Best for: Semi-annual data

YEARLY:
- Horizons: 1, 2, 3, 5, 10 years
- Test periods: 3 years
- Best for: Annual forecasts


=====================================================
MODEL DESCRIPTIONS
=====================================================

REGRESSION MODELS:
✓ Linear          - Simple trend line
✓ Ridge           - Linear with regularization
✓ Lasso           - Feature selection
✓ ElasticNet      - Ridge + Lasso combined

TREE MODELS:
✓ DecisionTree    - Single decision tree
✓ RandomForest    - Ensemble of trees
✓ ExtraTrees      - Randomized trees
✓ GradientBoosting- Sequential boosting
✓ XGBoost         - Advanced boosting

OTHER MODELS:
✓ KNN             - K-Nearest Neighbors
✓ SVR             - Support Vector Regression
✓ ARIMA           - Time series model

ADVANCED (Optional):
☐ AR1             - Simple autoregressive
☐ LSTM            - Neural network (slow)
☐ BVAR            - Bayesian VAR
☐ DFM             - Dynamic Factor Model
☐ GARCH           - Volatility model
☐ Naive           - Simple baseline


=====================================================
TOP N MODELS SETTING
=====================================================

Change Top N in Dashboard cell G5:
- 3  = Top 3 models (default)
- 5  = Top 5 models
- 10 = Top 10 models

Click "Refresh Charts" after changing to update visualizations.


=====================================================
DUMMY DATA VARIABLES
=====================================================

Generated variables (10 total):
1. CPI                      - Consumer Price Index
2. Real GDP Growth          - GDP growth %
3. BI7DRR                   - Bank Indonesia rate
4. Deposit Rate 1M          - 1-month deposit
5. Deposit Rate 3M          - 3-month deposit
6. Deposit Rate 6M          - 6-month deposit
7. Deposit Rate 12M         - 12-month deposit
8. Govt Bond Yield 10 Yr    - Government bonds
9. JISDOR Exchange Rate     - IDR/USD
10. FX                      - Exchange rate

Period: 246 months (2005-2025)


=====================================================
KEY IMPROVEMENTS
=====================================================

✅ NO external recipe files needed
✅ Self-contained configuration in Excel
✅ Visual model checklist (18 models)
✅ Default hyperparameters provided
✅ Frequency templates (Monthly/Quarterly/etc)
✅ Save custom recipes
✅ Dummy data matches recipe format
✅ Easy to adjust any setting
✅ All configuration visible in Recipe_Config sheet


=====================================================
TROUBLESHOOTING
=====================================================

ERROR: "No models selected"
→ Go to Recipe_Config, check at least one model in column A

ERROR: "No data loaded"
→ Click "Generate Dummy Data" first

ERROR: "Recipe name required"
→ Enter name in Dashboard cell B7 before saving

CHARTS NOT SHOWING:
→ Click "Refresh Charts"
→ Check Top N value in cell G5

SLOW PERFORMANCE:
→ Uncheck slow models (LSTM, BVAR, DFM)
→ Use fewer horizons
→ Reduce test split %


=====================================================
END OF VBA CODE
=====================================================

